<!DOCTYPE html>
<html>
<head>
    <title>í¼ ì œì¶œ ë””ë²„ê·¸</title>
</head>
<body>
    <h1>ë¸”ë¡œê·¸ ìƒì„± í¼ ì œì¶œ í…ŒìŠ¤íŠ¸</h1>
    <div id="result"></div>
    <button onclick="testFormSubmission()">í¼ ì œì¶œ í…ŒìŠ¤íŠ¸</button>
    
    <script>
        async function testFormSubmission() {
            console.log('í¼ ì œì¶œ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            document.getElementById('result').innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                // ì‹¤ì œ ë©”ì¸ í˜ì´ì§€ë¥¼ iframeìœ¼ë¡œ ë¡œë“œí•˜ê³  í¼ ì œì¶œ ì‹œë®¬ë ˆì´ì…˜
                console.log('ë©”ì¸ í˜ì´ì§€ì—ì„œ í¼ ë°ì´í„° ìˆ˜ì§‘ ì‹œë®¬ë ˆì´ì…˜');
                
                const formData = {
                    topic: '2026ë…„ AI ì „ë§ì§ì¢…',
                    audience: 'ì¤‘ê¸‰ì',
                    tone: 'ì¹œê·¼í•œ',
                    aiModel: 'auto',
                    enablePhase1: true,
                    enableSEO: false
                };
                
                console.log('ğŸ“¡ í¼ ë°ì´í„°:', formData);
                console.log('ğŸ“¡ API ìš”ì²­ ì‹œì‘...');
                
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                console.log('ğŸ“¡ API ì‘ë‹µ ë°›ìŒ:', response.status, response.statusText);
                console.log('ğŸ“¡ ì‘ë‹µ í—¤ë”ë“¤:', [...response.headers.entries()]);
                
                if (!response.ok) {
                    throw new Error(`API ì˜¤ë¥˜: ${response.status}`);
                }
                
                console.log('ğŸ“„ ì‘ë‹µ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì¤‘...');
                const responseText = await response.text();
                console.log('ğŸ“„ ì‘ë‹µ í…ìŠ¤íŠ¸ ê¸¸ì´:', responseText.length);
                console.log('ğŸ“„ ì‘ë‹µ ì‹œì‘ 200ì:', responseText.substring(0, 200));
                
                if (!responseText || responseText.trim() === '') {
                    throw new Error('ì„œë²„ì—ì„œ ë¹ˆ ì‘ë‹µì„ ë°›ì•˜ìŠµë‹ˆë‹¤');
                }
                
                let result;
                try {
                    result = JSON.parse(responseText);
                    console.log('âœ… JSON íŒŒì‹± ì„±ê³µ');
                } catch (parseError) {
                    console.error('âŒ JSON íŒŒì‹± ì‹¤íŒ¨:', parseError);
                    console.error('ì‘ë‹µ ì›ë¬¸:', responseText);
                    throw new Error('ì„œë²„ ì‘ë‹µì„ í•´ì„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
                
                console.log('âœ… ë¸”ë¡œê·¸ ìƒì„± ì™„ë£Œ:', result.metadata || result.model);
                
                document.getElementById('result').innerHTML = `
                    <h3>âœ… í¼ ì œì¶œ í…ŒìŠ¤íŠ¸ ì„±ê³µ!</h3>
                    <p><strong>ì œëª©:</strong> ${result.title}</p>
                    <p><strong>ëª¨ë¸:</strong> ${result.model}</p>
                    <p><strong>ì²­ì¤‘:</strong> ${result.metadata?.audience || 'N/A'}</p>
                    <p><strong>í†¤:</strong> ${result.metadata?.tone || 'N/A'}</p>
                    <p><strong>ì ìˆ˜:</strong> ${result.metadata?.qualityScore || 'N/A'}</p>
                    <p><strong>ê¸¸ì´:</strong> ${result.content?.length || 0} ë¬¸ì</p>
                `;
                
            } catch (error) {
                console.error('âŒ í¼ ì œì¶œ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜:', error);
                document.getElementById('result').innerHTML = `
                    <h3>âŒ í¼ ì œì¶œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</h3>
                    <p><strong>ì˜¤ë¥˜:</strong> ${error.message}</p>
                    <p><strong>ìŠ¤íƒ:</strong> ${error.stack || 'ì—†ìŒ'}</p>
                `;
            }
        }
    </script>
</body>
</html>